<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shooter Game</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: black;
    color: white;
    font-family: Arial, sans-serif;
  }
  #ui {
    position: fixed;
    top: 10px;
    left: 10px;
    font-size: 18px;
  }
  #gameOver {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    display: none;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    font-size: 30px;
  }
  button {
    padding: 10px 20px;
    font-size: 20px;
    cursor: pointer;
  }
</style>
</head>

<body>

<div id="ui">
  Score: <span id="score">0</span><br>
  Lives: <span id="lives">3</span>
</div>

<div id="gameOver">
  <div>GAME OVER</div>
  <button onclick="location.reload()">Restart</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let score = 0;
let lives = 3;
let gameRunning = true;

const player = {
  x: canvas.width / 2,
  y: canvas.height / 2,
  size: 10,
  speed: 5
};

const bullets = [];
const enemies = [];
const powerUps = [];
const keys = {};
let mouse = { x: 0, y: 0 };

// INPUT
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);
document.addEventListener("mousemove", e => {
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});
document.addEventListener("click", () => shoot());

// SHOOT
function shoot() {
  const angle = Math.atan2(mouse.y - player.y, mouse.x - player.x);
  bullets.push({
    x: player.x,
    y: player.y,
    dx: Math.cos(angle) * 8,
    dy: Math.sin(angle) * 8,
    size: 4
  });
}

// SPAWN ENEMIES
setInterval(() => {
  if (!gameRunning) return;
  enemies.push({
    x: Math.random() * canvas.width,
    y: -20,
    size: 12,
    speed: 2 + Math.random() * 2
  });
}, 800);

// SPAWN POWERUPS
setInterval(() => {
  powerUps.push({
    x: Math.random() * canvas.width,
    y: -20,
    size: 8,
    speed: 2
  });
}, 8000);

// GAME LOOP
function gameLoop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if (!gameRunning) return;

  // MOVE PLAYER
  if (keys["ArrowUp"] || keys["w"]) player.y -= player.speed;
  if (keys["ArrowDown"] || keys["s"]) player.y += player.speed;
  if (keys["ArrowLeft"] || keys["a"]) player.x -= player.speed;
  if (keys["ArrowRight"] || keys["d"]) player.x += player.speed;

  player.x = Math.max(player.size, Math.min(canvas.width - player.size, player.x));
  player.y = Math.max(player.size, Math.min(canvas.height - player.size, player.y));

  // DRAW PLAYER
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.size, 0, Math.PI * 2);
  ctx.fill();

  // BULLETS
  bullets.forEach((b, i) => {
    b.x += b.dx;
    b.y += b.dy;
    ctx.beginPath();
    ctx.arc(b.x, b.y, b.size, 0, Math.PI * 2);
    ctx.fill();
    if (b.x < 0 || b.x > canvas.width || b.y < 0 || b.y > canvas.height)
      bullets.splice(i,1);
  });

  // ENEMIES
  enemies.forEach((e, ei) => {
    e.y += e.speed;
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.arc(e.x, e.y, e.size, 0, Math.PI * 2);
    ctx.fill();

    // HIT PLAYER
    if (distance(e, player) < e.size + player.size) {
      enemies.splice(ei,1);
      lives--;
      document.getElementById("lives").textContent = lives;
      if (lives <= 0) endGame();
    }

    // BULLET COLLISION
    bullets.forEach((b, bi) => {
      if (distance(e,b) < e.size + b.size) {
        enemies.splice(ei,1);
        bullets.splice(bi,1);
        score++;
        document.getElementById("score").textContent = score;
      }
    });
  });

  // POWERUPS
  powerUps.forEach((p, pi) => {
    p.y += p.speed;
    ctx.fillStyle = "lime";
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
    ctx.fill();

    if (distance(p, player) < p.size + player.size) {
      lives++;
      document.getElementById("lives").textContent = lives;
      powerUps.splice(pi,1);
    }
  });

  requestAnimationFrame(gameLoop);
}

function distance(a,b) {
  return Math.hypot(a.x - b.x, a.y - b.y);
}

function endGame() {
  gameRunning = false;
  document.getElementById("gameOver").style.display = "flex";
}

gameLoop();
</script>

</body>
</html>
